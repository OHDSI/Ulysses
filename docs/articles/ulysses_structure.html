<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Ulysses Standard Repository Structure • Ulysses</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Ulysses Standard Repository Structure">
<meta property="og:description" content="Ulysses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ulysses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/get_started.html">Get Started with Ulysses</a>
    </li>
    <li>
      <a href="../articles/manifest.html">Using Input Manifests</a>
    </li>
    <li>
      <a href="../articles/ulysses_structure.html">The Ulysses Standard Repository Structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Ulysses Standard Repository Structure</h1>
            
      
      
      <div class="hidden name"><code>ulysses_structure.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Ulysses implements a standard repository structure for an RWE study.
A major part of the Ulysses philosophy is setting up a repo structure
that can be tracked with git. This turns an RWE study/pipeline into any
other software project. As RWE studies have taken on more and more
software elements, it is vital to institute consistent standards to
ensure that elements of the study are easily communicated for
collaboration on code and self-contained for consistent study execution
and versioning. In this vignette we describe the standard Ulysses
structure.</p>
</div>
<div class="section level2">
<h2 id="ulysses-repo-outline">Ulysses Repo Outline<a class="anchor" aria-label="anchor" href="#ulysses-repo-outline"></a>
</h2>
<p>A Ulysses repo will contain the following structure:</p>
<ul>
<li>analysis: folder containing functions that run the study; performing
an aggregation on a study population</li>
<li>inputs: folder containing input files needed to specify study
populations and clinical assumptions such as medical codes</li>
<li>dissemination: folder organizing outputs that should be committed to
the git repository</li>
<li>exec: folder containing the raw output results and logs from the
study execution. Should not be commited to git</li>
<li>extras: folder containing extra files necessary for the study</li>
<li>config.yml: a settings file that describes the database and schema
parameters used for a study execution</li>
<li>README.md: the cover-page of the repo describing aspects of the
study</li>
<li>NEWS.md: the change log of the repo describing changes to the study
over time</li>
<li>.Rproj: an R administrative file that identifies the folder as an R
projects and simplifies folder routing</li>
<li>.gitignore: a file specifying which files should not be tracked by
git</li>
</ul>
<p>Next we will get into more details about each element in the
structure.</p>
</div>
<div class="section level2">
<h2 id="elements-of-the-ulysses-repo">Elements of the Ulysses Repo<a class="anchor" aria-label="anchor" href="#elements-of-the-ulysses-repo"></a>
</h2>
<div class="section level3">
<h3 id="vital-files">Vital Files<a class="anchor" aria-label="anchor" href="#vital-files"></a>
</h3>
<div class="section level4">
<h4 id="rproj">.Rproj<a class="anchor" aria-label="anchor" href="#rproj"></a>
</h4>
<p>The .Rproj file is an administrative file designed for the RStudio
IDE that encapsulates the contents (code, settings, and docs) required
for a coding project in R. The biggest benefits of the .RProj file is
that it ensures that file paths are relative to the project root. A very
common break point in custom coded RWE study is the use of absolute
locations, that are based on the file structure of the developer’s
machine. Absolute paths allow repos to be more portable and
collaborative. In general the .RProj encourages reproducibility of code
and workspace isolation to avoid interfering settings options.</p>
</div>
<div class="section level4">
<h4 id="gitignore">.gitignore<a class="anchor" aria-label="anchor" href="#gitignore"></a>
</h4>
<p>The .gitignore file specifies which files should not be tracked by a
git enabled repository. We do not want to commit all files to a git
remote, because it would be available for all to see. User profiles,
patient level data, and credential files should never be committed to a
git repository. .RData and .RHistory are other misc files that should
not be committed due to potentital leakage of credentials and sensitive
information. Ulysses sets the gitignore file to automatically ignore:
.Rproj.user, .RData, .RHistory and exec/results.</p>
</div>
<div class="section level4">
<h4 id="readme">README<a class="anchor" aria-label="anchor" href="#readme"></a>
</h4>
<p>The README is a markdown file that serves as the cover-page of the
repository. It should communicate the essential elements of the RWE
study such as a description of the study, key personnel and study
status. The README file holds important project tracking/management
information that can be leveraged within an organizations git host
setup. The README also stores tags and links. Tags serve as keywords to
search similar stuides within an organization. Links provide access to
vital html widgets or cloud hosted documents linked to the study. On
launch, Ulysses initializes the README with a template but it is highly
suggested that users update the README according to the expectations of
their organization and ease the communication of the project.</p>
</div>
<div class="section level4">
<h4 id="news">NEWS<a class="anchor" aria-label="anchor" href="#news"></a>
</h4>
<p>The NEWS is a markdown file that serves as the change-log for the
repository. It is common practice in software projects that developers
release notes describing changes from the previous release of the
software. In an RWE study it is very common that a request evolves. For
example a cohort definition changes or an analysis assumption is removed
based on preliminary data. It is essential that these major changes are
documented over the life-cycle of the RWE study. While git tracks
changes to code through commits, the NEWS file summarizes the series of
commits from version to version. Typically we use <a href="https://semver.org/" class="external-link">semantic versioning</a> for Ulysses studies,
incrementing releases based on either the level of impact it has on the
pipeline or level of dissemeniation. The NEWS file should be brief, with
a bulleted list of changes from the previous version.</p>
</div>
<div class="section level4">
<h4 id="config-yml">config.yml<a class="anchor" aria-label="anchor" href="#config-yml"></a>
</h4>
<p>This is crucial settings file specifies the parameters needed to
establish a connection to the database hosting RWD using
<code>DatabaseConnector</code>. The config file uses <a href="https://yaml.org/" class="external-link">Yaml</a> a simple, readable data-serialization
language used to provide settings or configurations for applications.
The config file has two types of sections: default and block headers.
The default block holds universal settings while the block header
specifies details when the user has specified the block. When we source
a block header in a task file, it will run the task based only on the
block. This allows us to run pipelines easily on multiple databases.
Credentials needed to run a study are as follows:</p>
<ul>
<li>
<strong>dbms</strong>: the name of the dbms used to host the OMOP
data</li>
<li>
<strong>user</strong>: your user name needed to access the data in
the dbms</li>
<li>
<strong>password</strong>: your password needed to access the data
in the dbms</li>
<li>
<strong>connectionString</strong>: this string sets the connection
to the database. It will typically look something like:
<code>jdbc:&lt;dbms&gt;://&lt;server url&gt;:&lt;dbms port&gt;/&lt;database&gt;</code>.
This string will vary from site to site. Contact your system
administrator to get the information you need for this credential</li>
<li>
<strong>databaseName</strong>: the name of the database used for
reference. This should be stored in a snakecase format including the
name of the database and snapshot date</li>
<li>
<strong>databaseLabel</strong>: the pretty label of the database
used for final formats</li>
<li>
<strong>cdmDatabaseSchema</strong>: a name that defines where the
cdm tables sit for a particular database in the dbms.
<code>Database</code> defines the name of the database where the omop
data sits and the <code>Schema</code> defines where the cdm is within
that database. In databases like sql server or snowflake this variable
is often separated by a “.” i.e. &lt;database&gt;.&lt;schema&gt;</li>
<li>
<strong>vocabDatabaseSchema</strong>: a name that defines where the
vocabulary tables sit for a particular database in the dbms. The
vocabDatabaseSchema is typically the same as the cdmDatabaseSchema,
although same sites split the vocabulary into a different area.</li>
<li>
<strong>workDatabaseSchema</strong>: a name that defines where the
work tables sit for a particular database in the dbms. The work section
(referred to synonymously with scratch or write) is an area where the
user is given read and write access in the database. The
cdmDatabaseSchema is typically only a read-only schema, so users do not
corrupt information. The workDatabaseSchema is a dedicated area where
researchers can build cohort tables or other intermediary tables needed
for studies. Contact your database administrator to ensure you have a
dedicated workDatabaseSchema. Note this should be separate from the
database schema dedicated to ATLAS.</li>
<li>
<strong>tempEmulationSchema</strong> (Optional): this is a schema
used to evaluate temp tables in certain databases like snowflake and
oracle.</li>
<li>
<strong>cohortTable</strong>: the name of the cohort table to create
in the work schema. By default this will take the repo name and database
name in snakecase.</li>
</ul>
<p>Below is an example of a config file:</p>
<pre><code># Config File for my_ohdsi_study

default:
  projectName: my_ohdsi_study
  version: v0.0.1
  
# Config block for example

example:
  dbms: snowflake
  user: !expr Sys.getenv('dbUser')
  password: !expr Sys.getenv('dbPassword')
  connectionString: !expr Sys.getenv('dbConnectionString')
  databaseName: my_cdm
  databaseLabel: My CDM
  cdmDatabaseSchema: cdm_schema
  vocabDatabaseSchema: cdm_schema
  workDatabaseSchema: work_schema
  tempEmulationSchema: temp_schema
  cohortTable: o99996_example
</code></pre>
<p>If we wanted to add another credential in this block we can add new
line beneath <code>cohortTable</code>. Be sure to keep the indentation
and add an extra space after.</p>
</div>
</div>
<div class="section level3">
<h3 id="analysis-folder">Analysis Folder<a class="anchor" aria-label="anchor" href="#analysis-folder"></a>
</h3>
<p>The analysis folder contains all R code that executes the RWE study.
There are two sub-sections: tasks and src (pronounced source). Tasks are
files that implement the RWE pipeline when we call an execute command.
<strong>src</strong> internal files maintain code that helps run these
functions.</p>
<p>The task folder maintains a numbered list of files that run an
element of the pipeline. Task files follow this general cadence: a) list
parameters and assumptions b) connect to the database, c) extract
aggregations from database based on specifications [this may include
additional steps using R], and d) store output to the correct results
folder. In each task file we specify a configBlock. As stated in the
config.yml section, the config block specifies the block header of the
data we want to use in the connection. This allows us to reuse the same
task code to run on multiple databases.</p>
</div>
<div class="section level3">
<h3 id="inputs-folder">Inputs Folder<a class="anchor" aria-label="anchor" href="#inputs-folder"></a>
</h3>
<p>The inputs folder is meant to organize files that are used to
generate cohort definitions and concept sets in the database. When using
OHDSI tools, cohort definitions and concept sets are specified in a
<code>json</code> file format following the specifications of <a href="https://github.com/OHDSI/circe-be" class="external-link"><code>circe-be</code></a>. We
suggest placing cohorts used in the analysis in the inputs folder in
order for the study to be self-contained. Keeping track of cohorts can
be a bit tricky. Ulysses provides manifest functions to maintain the
organization of these inputs, described in another vignette. The inputs
folder has the following sub-folders:</p>
<ul>
<li>cohorts: location of objects describing the logic of study
population for analysis
<ul>
<li>/json: in OHDSI studies the json folder holds circe-be definitions
that have standard serialization to sql</li>
<li>/sql: some studies require custom sql to implement a cohort. Custom
sql should be stored here</li>
</ul>
</li>
<li>conceptSets: storage of code lists used to describe clinical
entities used in the analysis -/json: in OHDSI studies concept sets are
described in circe-be. This allows for more efficient use of vocabulary
hierachy.</li>
</ul>
<p>When manifests are enables, there will be csv files tracking the
life-cycle of study input assets in this folder as well.</p>
</div>
<div class="section level3">
<h3 id="dissemination-folder">Dissemination Folder<a class="anchor" aria-label="anchor" href="#dissemination-folder"></a>
</h3>
<p>Every RWE Study needs to disseminate content explaining the
assumptions and results of the study. All of these files are stored in
the dissemination folder within Ulysses. There are some sub-folders:</p>
<ul>
<li>documents: stores important documentation for the study. Possible
complimentary literature or a word doc of the study protocol would be
stored here</li>
<li>export: stores data that is ready for export and may be stored in
git
<ul>
<li>/merge: holds csv files merging different cohorts and data sources
run in the pipeline. This data format is long.</li>
<li>/pretty: holds xlsx files storing pivoted results to send to
stakeholders. This data format is custom based on the stakeholder
request.</li>
</ul>
</li>
<li>quarto: holds files needed to build and host the study hub. Details
to follow.</li>
</ul>
<div class="section level4">
<h4 id="study-hub">Study Hub<a class="anchor" aria-label="anchor" href="#study-hub"></a>
</h4>
<p>The StudyHub is the website of the RWE study, a series of linked html
files that describe the studies, outline assumptions and communicate
results. A StudyHub uses quarto websites to weave together multiple html
files in a single linked website. Each study should have a hub
communicating final results in a sleak html format. This is analgous to
a package website built using <code>pkgdown</code> for sites
communicating the ideas of an R package. A study hub has the following
elements:</p>
<ul>
<li>_quarto.yml: a settings file dictating how to knit the quarto
website</li>
<li>egp.qmd: A quarto file communicating the layman assumptions used in
the RWE study. More details about the EGP are left for another
vignette.</li>
<li>images: optional folder to add images</li>
<li>index.qmd: A quarto file copying the README.md file serving as the
cover-page of the study hub for html</li>
<li>news.qmd: A quarto file copying the NEWS.md file for html</li>
<li>R: A folder holding R scripts that may be referenced in the study
hub for rendering tables or figures</li>
<li>report: A folder holder qmd files to use in the report</li>
<li>style.css: a file that dictates universal html stylings such as
color schemes</li>
<li>_site: a folder created after the first build of the StudyHub
holding rendered html files</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="extras-folder">Extras Folder<a class="anchor" aria-label="anchor" href="#extras-folder"></a>
</h3>
<p>Sometimes studies have files that don’t have a natural location from
those specified above. The extras folder is a location to store any
additional files needed to run or support the execution of the
study.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin Lavallee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
