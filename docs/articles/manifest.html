<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Input Manifests • Ulysses</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Input Manifests">
<meta property="og:description" content="Ulysses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ulysses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/get_started.html">Get Started with Ulysses</a>
    </li>
    <li>
      <a href="../articles/git.html">Using Git in Ulysses</a>
    </li>
    <li>
      <a href="../articles/manifest.html">Using Input Manifests</a>
    </li>
    <li>
      <a href="../articles/ulysses_structure.html">The Ulysses Standard Repository Structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using Input Manifests</h1>
            
      
      
      <div class="hidden name"><code>manifest.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Manifests are files the track inputs that are needed for a study.
Ulysses provides a series of helper functions to initialize and populate
manifest files to keep inputs to a study organized and tracked. The idea
of the manifest is to track input file and its progression over the
study life cycle. There are two kinds of manifests: concept set and
cohort. Additionally there are two file types: manifest and manifestLog.
The manifestLog file adds in checks to ensure if an asset has been
deprecated. Users only need to look at the manifest file. The log is
used to resolve updates over time.</p>
<div class="section level3">
<h3 id="cohort-manifest">Cohort Manifest<a class="anchor" aria-label="anchor" href="#cohort-manifest"></a>
</h3>
<p>The cohort manifest tracks assets that define study populations and
cohorts of interest in a study. With OHDSI tools, we track a “circe-be”
object that lists the logic of a cohort definition in a json file which
can be serialized into a standard sql script that can be consistently
executed to enumerate the population of interest. Ulysses is optimized
to track the json representations of cohorts, but one can easily alter
this to tracking a custom sql script.</p>
</div>
<div class="section level3">
<h3 id="concept-set-manifest">Concept Set Manifest<a class="anchor" aria-label="anchor" href="#concept-set-manifest"></a>
</h3>
<p>The concept set manifest tracks assets that capture clinical
terminology used in a study. More commonly these are thought of as code
lists. The json file stored in Ulysses is optimized for OHDSI tools,
however it can be easily altered to use code list csvs for raw database
analyses.</p>
<div class="section level4">
<h4 id="a-tangent-on-concept-sets">A tangent on Concept Sets<a class="anchor" aria-label="anchor" href="#a-tangent-on-concept-sets"></a>
</h4>
<p>A concept set describes a clinical term plus its related terms,
including descendancy and mapped terms. With the OMOP CDM we use
standard vocabularies to represent clinical terms and improve roll-up
logic to additional terms. Each standard term has parents and children
nodes that form the heirarchy of the clinical term. For example diabetes
includes: type 1 and type 2 diabetes. Instead of searching for each
descendant term, I could identify the parent term and include its
descendant concepts; a more efficient way to represent code lists
programmatically. On a related note, clinical terms have different
coding in different databases. For example CPRD uses READ codes while a
typical US claims database uses ICD10CM. Standard vocabularies allow us
to efficiently identify clinical terms across different databases
following a standard representation. Concept sets in OHDSI allow us to
do this!</p>
</div>
</div>
<div class="section level3">
<h3 id="manifest-structure">Manifest Structure<a class="anchor" aria-label="anchor" href="#manifest-structure"></a>
</h3>
<p>A manifest file is a csv that tracks important fields in a tabular
fashion. They include the following fields:</p>
<ul>
<li>id: this is the manifest Id, it should not be touched</li>
<li>atlasId: the id of the asset as stored in WebApi</li>
<li>label: the common name for asset</li>
<li>category: a category tag that gives the asset a identification
group</li>
<li>subCategory: a sub category tag that gives a second identification
group</li>
<li>name: a file name of the asset</li>
<li>path: the relative path of the asset file</li>
</ul>
<p>The manifestLog adds a field called isDeprecated which tracks whether
the asset still exists in the file structure.</p>
</div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>Below we provide an example of how to use the manifest functions from
Ulysses to track cohorts and concept sets over the study life-cycle.</p>
<div class="section level3">
<h3 id="step-1-initialize-the-manifest">Step 1: Initialize the Manifest<a class="anchor" aria-label="anchor" href="#step-1-initialize-the-manifest"></a>
</h3>
<p>To start we initialize the manifest, creating an empty table for each
manifest type.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># initialize cohort manifest</span></span>
<span><span class="fu"><a href="../reference/initializeManifest.html">initializeManifest</a></span><span class="op">(</span>manifestType <span class="op">=</span> <span class="st">"cohort"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize concept set manifest</span></span>
<span><span class="fu"><a href="../reference/initializeManifest.html">initializeManifest</a></span><span class="op">(</span>manifestType <span class="op">=</span> <span class="st">"conceptSet"</span><span class="op">)</span></span></code></pre></div>
<p>Once the manifest is initialized for the first time, we can then
manually added content into the file. Open the raw version of the file
and add details. See example below:</p>
<pre><code>atlasId,label,category,subCategory,id,name,path
123,Type 2 Diabetes,target,,,,,
456,Heart Failure,outcome,condition,,,</code></pre>
<p>Do not fill in the id, name and path columns. These are filled out by
the populateManifest function. Notice we add in the labelling
information that we know such as the atlasId, the label of the asset and
the grouping categories.</p>
<p>It is also possible to load this information prior to initializing
the manifest using the function <code><a href="../reference/defineLoadTable.html">defineLoadTable()</a></code>, see
example below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set cohorts to use</span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineLoadTable.html">defineLoadTable</a></span><span class="op">(</span></span>
<span>  atlasId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123</span>,<span class="fl">456</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Type 2 Diabetes"</span>, <span class="st">"Heart Failure"</span><span class="op">)</span>,</span>
<span>  category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"target"</span>, <span class="st">"outcome"</span><span class="op">)</span>,</span>
<span>  subCategory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA_character_</span>, <span class="st">"condition"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># init cohort Manifest</span></span>
<span><span class="fu"><a href="../reference/initializeManifest.html">initializeManifest</a></span><span class="op">(</span></span>
<span>  manifestType <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  loadTable <span class="op">=</span> <span class="va">tb</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>By importing the prespecified table, we do not need to manually add
this to the manifest csv file.</p>
<p>The <code>initializeManifest</code> function has one more option
called overwrite. This will remove any existing manifest with a newly
initialized manifest.</p>
</div>
<div class="section level3">
<h3 id="step-2-populate-the-manifest">Step 2: Populate the Manifest<a class="anchor" aria-label="anchor" href="#step-2-populate-the-manifest"></a>
</h3>
<p>Once the manifest has been initialized, it is time to populate the
information. The populate step takes cohorts or concept sets saved as
files and stores them as entries in the manifest using the meta
information applied, such as the label.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/populateManifest.html">populateManifest</a></span><span class="op">(</span>manifestType <span class="op">=</span> <span class="st">"cohort"</span>, importFromAtlas <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Populate manifest will only fill out information for files that exist
in the cohorts or concept set folders. You can do this manually or use
the importFromAtlas utility. This option uses your webApi credentials to
connect and scrap circe json to place in Ulysses. In order to use the
importFromAtlas feature, users need to configure a connection to WebApi.
See that section for details.</p>
</div>
</div>
<div class="section level2">
<h2 id="set-up-webapi-connection">Set up WebApi Connection<a class="anchor" aria-label="anchor" href="#set-up-webapi-connection"></a>
</h2>
<div class="section level3">
<h3 id="set-credentials">Set Credentials<a class="anchor" aria-label="anchor" href="#set-credentials"></a>
</h3>
<p>Before a use can import atlas assets, they need to set their WebApi
credentials as system variables to pass through authentication. Ulysses
stores WebApi credentials in .Renviron file. To access the
<code>.Renviron</code> file use the function:
<code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code>. Ulysses offers a template
function to provide guidance of the proper credential set up:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/templateAtlasCredentials.html">templateAtlasCredentials</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To find the baseUrl you can look in the configuration tab of Atlas.
The user is usually an email address if the authentication method is ad
and the password is the password to the corresponding user. Please
contact someone in your organization for details. Input these items into
the <code>.Renviron()</code> and restart the session to invoke the
changes.</p>
</div>
<div class="section level3">
<h3 id="atlas-connection-object">Atlas Connection Object<a class="anchor" aria-label="anchor" href="#atlas-connection-object"></a>
</h3>
<p>Once credentials have been set, users can create a WebApiConnection
R6 class that manages credentials, authorization and scraping of assets.
Note that this is all handled implicitly in the
<code>populateManifest</code> function. This section only provides
additional details.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlasCon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setAtlasConnection.html">setAtlasConnection</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create object</span></span>
<span><span class="va">atlasCon</span><span class="op">$</span><span class="fu">checkAtlasCredentials</span><span class="op">(</span><span class="op">)</span> <span class="co"># check credentials. note password is hidden</span></span>
<span><span class="va">atlasCon</span><span class="op">$</span><span class="fu">getCohortDefinition</span><span class="op">(</span>cohortId <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="co"># grab cohort def from WebApi</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin Lavallee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
